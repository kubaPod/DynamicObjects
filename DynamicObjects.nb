Notebook[{

Cell[CellGroupData[{
Cell["DynamicObjects", \
"Title",ExpressionUUID->"09b9053d-f2d2-4466-8923-d8f23858e7fa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PacletDirectoryAdd", " ", "@", " ", 
  RowBox[{"NotebookDirectory", "[", "]"}]}], "\n", 
 RowBox[{"SetDirectory", " ", "@", " ", 
  RowBox[{"NotebookDirectory", "[", "]"}]}], "\n", 
 RowBox[{"<<", "DynamicObjects`"}]}], "Code",
 CellLabel->"In[1]:=",ExpressionUUID->"ddd7a098-3ccb-435a-8e57-39a65b9aab13"],

Cell[BoxData[
 RowBox[{"{", \
"\<\"C:\\\\Users\\\\Kuba\\\\IdeaProjects\\\\DynamicObjects\\\\\"\>", 
  "}"}]], "Output",
 CellLabel->"Out[1]=",ExpressionUUID->"c05198f2-8dd0-40ca-bc0c-977a0b23be66"],

Cell[BoxData["\<\"C:\\\\Users\\\\Kuba\\\\IdeaProjects\\\\DynamicObjects\"\>"],\
 "Output",
 CellLabel->"Out[2]=",ExpressionUUID->"fc318c60-d1ef-4a80-a21c-85f85a9f6021"]
}, Open  ]],

Cell[CellGroupData[{

Cell["notes", \
"Section",ExpressionUUID->"1a986ba3-fbf9-4fe2-b220-642dd85c3a8b"],

Cell["\<\
It is not a golden hammer.

It should help when there are multiple dynamic objects in your interface but \
you want to modify single/small groups of them independently.

To modify all of them at once different approaches would be more appropriate. \
e..g controlling positions as GraphicsComplex spec, redrawing all at once \
rather than each one etc.\
\>", "Text",ExpressionUUID->"8a6490d0-79a7-4015-b488-afca7a44a2af"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LightLocator", \
"Section",ExpressionUUID->"5ccf4960-75ad-4fb0-8d6e-8acae9e3df60"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LightLocator", " ", "//", " ", "Attributes"}], " ", "=", " ", 
     RowBox[{"{", "HoldFirst", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"LightLocator", "[", 
     RowBox[{"pos_", ",", " ", 
      RowBox[{"appearance_:", " ", 
       RowBox[{"Dynamic", " ", "@", " ", 
        RowBox[{"FrontEnd`CurrentValue", "[", 
         RowBox[{"{", 
          RowBox[{"TaggingRules", ",", "\"\<locator\>\""}], "}"}], 
         "]"}]}]}]}], "]"}], ":=", 
    RowBox[{"EventHandler", "[", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"Inset", "[", " ", 
       RowBox[{"appearance", ",", " ", "pos"}], "]"}], "\n", ",", " ", 
      RowBox[{"\"\<MouseDragged\>\"", " ", "\[RuleDelayed]", " ", 
       RowBox[{"FEPrivate`Set", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"FrontEnd`CurrentValue", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<MousePosition\>\"", ",", "\"\<Graphics\>\""}], "}"}], 
          "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Code",
 CellLabel->"In[4]:=",ExpressionUUID->"d2cf9668-4055-4c33-9d01-f8849f8e45c2"]
}, Closed]],

Cell[CellGroupData[{

Cell["locator, syntax and performance comparison", \
"Section",ExpressionUUID->"6e0f8577-ff34-4c5f-a915-8504283a7ec0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opts", "=", " ", 
   RowBox[{"Sequence", "[", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "1"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "333"}]}], "]"}]}], ";"}]}], "Code",
 CellLabel->"In[6]:=",ExpressionUUID->"04eced82-8236-4afc-98a9-1f5f6ce204c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"customLocator", "=", 
    RowBox[{"MouseAppearance", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Mouseover", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"Disk", "[", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Blue", ",", 
             RowBox[{"Disk", "[", "]"}]}], "}"}]}], "]"}], "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "17"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "\"\<LinkHand\>\""}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Deploy", "@", 
  RowBox[{"Panel", "@", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<Locator's default appearance\>\"", ",", 
           "\"\<Subsubsection\>\""}], "]"}], ",", "SpanFromLeft", ",", 
         "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DynamicModule", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pts1", "=", "pts"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Slider", "@", 
                 RowBox[{"Dynamic", "@", 
                  RowBox[{"pts1", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], "}"}], "]"}],
              "&"}], "@", 
            RowBox[{"LocatorPane", "[", 
             RowBox[{
              RowBox[{"Dynamic", "@", "pts1"}], ",", 
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", "opts", ",", 
                RowBox[{"PlotLabel", "\[Rule]", "\"\<LocatorPane\>\""}]}], 
               "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"DynamicModule", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pts1", "=", "pts"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Slider", "@", 
                 RowBox[{"Dynamic", "@", 
                  RowBox[{"pts1", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], "}"}], "]"}],
              "&"}], "@", 
            RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", "=", "i"}], "}"}], ",", 
                  RowBox[{"Locator", "[", 
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"pts1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "opts", ",", 
              RowBox[{
              "PlotLabel", "\[Rule]", 
               "\"\<Table Locator@Dynamic@pts[[i]]\>\""}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"FrontEndModule", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Slider", "@", 
                 RowBox[{"Dynamic", "@", 
                  RowBox[{
                   RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<point\>\"", ",", "1"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], "]"}], "&"}], 
            "@", 
            RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"Locator", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "@", 
                   RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<point\>\"", ",", "#"}], "]"}]}], ",", 
                  RowBox[{"Dynamic", "@", 
                   RowBox[{"FrontEnd`CurrentValue", "[", 
                    RowBox[{"{", 
                    RowBox[{"TaggingRules", ",", "\"\<locator\>\""}], "}"}], 
                    "]"}]}]}], "]"}], "&"}], "/@", 
               RowBox[{"Range", "@", "n"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsolutePointSize", "@", "7"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"LightLocator", "[", 
                   RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<point\>\"", ",", "#"}], "]"}], "]"}], "&"}], 
                 "/@", 
                 RowBox[{"Range", "[", "n", "]"}]}]}], "\[IndentingNewLine]", 
               "}"}], ",", "\[IndentingNewLine]", "opts", ",", 
              RowBox[{
              "PlotLabel", "\[Rule]", 
               "\"\<Table LightLocator@FrontEndSymbol\>\""}]}], 
             "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Initialization", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", "=", "i"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"FrontEndSymbol", "[", 
                   RowBox[{"\"\<point\>\"", ",", "i"}], "]"}], "=", 
                  RowBox[{"pts", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ")"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<Locator's custom appearance\>\"", ",", 
           "\"\<Subsubsection\>\""}], "]"}], ",", "SpanFromLeft", ",", 
         "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DynamicModule", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pts1", "=", "pts"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Slider", "@", 
                 RowBox[{"Dynamic", "@", 
                  RowBox[{"pts1", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], "}"}], "]"}],
              "&"}], "@", 
            RowBox[{"LocatorPane", "[", 
             RowBox[{
              RowBox[{"Dynamic", "@", "pts1"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Inset", "[", 
                    RowBox[{"customLocator", ",", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"pts1", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}]}], "]"}], "&"}], "/@", 
                  RowBox[{"Range", "@", "n"}]}], "}"}], ",", "opts", ",", 
                RowBox[{
                "PlotLabel", "\[Rule]", 
                 "\"\<LocatorPane (mouseover does not work)\>\""}]}], "]"}], 
              ",", 
              RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"DynamicModule", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pts1", "=", "pts"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Slider", "@", 
                 RowBox[{"Dynamic", "@", 
                  RowBox[{"pts1", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], "}"}], "]"}],
              "&"}], "@", 
            RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", "=", "i"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Locator", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"pts1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "None"}], 
                    "]"}], ",", 
                    RowBox[{"Inset", "[", 
                    RowBox[{"customLocator", ",", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"pts1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "opts", ",", 
              RowBox[{
              "PlotLabel", "\[Rule]", 
               "\"\<Table Locator@Dynamic@pts[[i]]\>\""}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"FrontEndModule", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Slider", "@", 
                 RowBox[{"Dynamic", "@", 
                  RowBox[{
                   RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<point\>\"", ",", "1"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], "]"}], "&"}], 
            "@", 
            RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"Locator", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "@", 
                   RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<point\>\"", ",", "#"}], "]"}]}], ",", 
                  RowBox[{"Dynamic", "@", 
                   RowBox[{"FrontEnd`CurrentValue", "[", 
                    RowBox[{"{", 
                    RowBox[{"TaggingRules", ",", "\"\<locator\>\""}], "}"}], 
                    "]"}]}]}], "]"}], "&"}], "/@", 
               RowBox[{"Range", "@", "n"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsolutePointSize", "@", "7"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"LightLocator", "[", 
                   RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<point\>\"", ",", "#"}], "]"}], ",", 
                    "customLocator"}], "]"}], "&"}], "/@", 
                 RowBox[{"Range", "[", "n", "]"}]}]}], "\[IndentingNewLine]", 
               "}"}], ",", "\[IndentingNewLine]", "opts", ",", 
              RowBox[{
              "PlotLabel", "\[Rule]", 
               "\"\<Table LightLocator@FrontEndSymbol\>\""}]}], 
             "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Initialization", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", "=", "i"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"FrontEndSymbol", "[", 
                   RowBox[{"\"\<point\>\"", ",", "i"}], "]"}], "=", 
                  RowBox[{"pts", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ")"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"TaggingRules", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<locator\>\"", "\[Rule]", 
          RowBox[{"RawBoxes", "@", 
           RowBox[{
            RowBox[{"FrontEndResource", "[", 
             RowBox[{
             "\"\<FEExpressions\>\"", ",", "\"\<LocatorDefaultThumb\>\""}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}]}], "}"}]}]}], 
    "]"}]}]}]}], "Code",ExpressionUUID->"f2daf7d5-b49f-4df1-9f23-fdec73c1c6d0"]
}, Closed]],

Cell[CellGroupData[{

Cell["FrontEnd side programming", \
"Section",ExpressionUUID->"e58f6f66-300e-47d7-9d2c-75ee613300ee"],

Cell[CellGroupData[{

Cell["FEPrivate`Set guidelines", \
"Subsection",ExpressionUUID->"166aadf6-8c6b-46ae-9508-1e9c29cf3c1e"],

Cell["this can work fe side", \
"Item",ExpressionUUID->"d8681742-8c10-4235-9f8a-624ed3ce3bff"],

Cell[BoxData[
 RowBox[{"FEPrivate`Set", "[", 
  RowBox[{"_Symbol", ",", 
   RowBox[{"_String", "|", "_Real", "|", "_Integer", "|", "_RGBColor"}]}], 
  "]"}]], "Code",ExpressionUUID->"b3145a8b-b1c7-432a-94b6-abab75a966b6"],

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "=", "Blue"}], ",", 
     RowBox[{"y", "=", "Blue"}]}], "}"}], ",", 
   RowBox[{"(*", 
    RowBox[{"run", " ", "in", " ", "link", " ", "snooper", " ", "kernel"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\<test\>\"", ",", 
         RowBox[{"FEPrivate`Set", "[", 
          RowBox[{"x", ",", 
           RowBox[{"LABColor", "[", "1", "]"}]}], "]"}], ",", 
         RowBox[{"Evaluator", "\[Rule]", "Automatic"}]}], "]"}], ",", 
       RowBox[{"Dynamic", "[", 
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Code",
 CellLabel->"In[57]:=",ExpressionUUID->"b843de73-c6ea-4b60-9c3f-0a997cae41d3"],

Cell["\<\
One needs to keep in mind that even if assignment is FE side, effets it has \
on the view may need kernel, even for simple cases. For example Dynamic[ x ] \
where x = {1, 2} already needs to be sent to the kernel because FE does not \
know how to make boxes of a List. Otoh `{Dynamic[x[[1]]], Dynamic[x[[2]]]}` \
does not need to go through kernel. FE can handle Part and if it is a \
\[OpenCurlyQuote]simple\[CloseCurlyQuote] value then it can display it.
We assume of course that x is FE owned variable (DynamicModule).\
\>", "Text",ExpressionUUID->"00f418b5-c722-41c9-a58c-9c7c694015ee"]
}, Closed]],

Cell[CellGroupData[{

Cell["Graphics @ { DynamicBox[...], ...}", \
"Subsection",ExpressionUUID->"22e65947-f56c-4c8d-84ae-a53582b413a9"],

Cell[BoxData[
 RowBox[{"Options", "[", 
  RowBox[{"$FrontEnd", ",", "DynamicBoxOptions"}], "]"}]], "Code",
 CellLabel->"In[56]:=",ExpressionUUID->"ebac4428-cb57-42a6-bdb4-1241b6b97dcf"],

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "=", "Blue"}], ",", 
     RowBox[{"y", "=", "Blue"}]}], "}"}], ",", 
   RowBox[{"(*", 
    RowBox[{"run", " ", "in", " ", "link", " ", "snooper", " ", "kernel"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Button", "[", 
         RowBox[{"\"\<test\>\"", ",", 
          RowBox[{"FEPrivate`Set", "[", 
           RowBox[{"x", ",", 
            RowBox[{"LABColor", "[", 
             RowBox[{".5", ",", ".8", ",", ".8"}], "]"}]}], "]"}], ",", 
          RowBox[{"Evaluator", "\[Rule]", "Automatic"}]}], "]"}], ",", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"x", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Dynamic", "[", "x", "]"}], ",", 
           RowBox[{"Disk", "[", "]"}]}], "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Button", "[", 
         RowBox[{"\"\<test\>\"", ",", 
          RowBox[{"FEPrivate`Set", "[", 
           RowBox[{"y", ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
          RowBox[{"Evaluator", "\[Rule]", "Automatic"}]}], "]"}], ",", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"y", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DynamicBox", "[", "y", "]"}], ",", 
           RowBox[{"Disk", "[", "]"}]}], "}"}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Code",
 CellLabel->"In[49]:=",ExpressionUUID->"66a0356b-cb14-41fa-828c-591b483e73fd"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Color friendly pattern (not a good idea)", \
"Section",ExpressionUUID->"fb42db42-d254-4884-afa9-20fc62cdba57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hold", "[", 
   RowBox[{"Red", ",", 
    RowBox[{"Print", "[", "1", "]"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{"c_", "?", "ColorQ"}], "\[RuleDelayed]", 
   RowBox[{"RuleCondition", "@", "c"}]}]}]], "Code",
 CellLabel->"In[1]:=",ExpressionUUID->"18117f90-5341-4089-ba08-2f4a24e3b986"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$namedColors", " ", "=", " ", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"HoldPattern", "@", 
       RowBox[{"Alternatives", "[", "\[IndentingNewLine]", 
        RowBox[{
        "Black", ",", "Blue", ",", "Brown", ",", "Cyan", ",", "Gray", ",", 
         "Green", ",", "LightBlue", ",", "LightBrown", ",", "LightCyan", ",", 
         "LightGray", ",", "LightGreen", ",", "LightMagenta", ",", 
         "LightOrange", ",", "LightPink", ",", "LightPurple", ",", "LightRed",
          ",", "LightYellow", ",", "Magenta", ",", "Orange", ",", "Pink", ",",
          "Purple", ",", "Red", ",", "Transparent", ",", "White", ",", 
         "Yellow"}], "\[IndentingNewLine]", "]"}]}], ",", "Alternatives"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$colorModels", "=", 
    RowBox[{
     RowBox[{"Verbatim", "[", "\[IndentingNewLine]", 
      RowBox[{
      "RGBColor", "|", "Hue", "|", "CMYKColor", "|", "GrayLevel", "|", 
       "LABColor", "|", "LCHColor", "|", "LUVColor", "|", "XYZColor"}], 
      "\[IndentingNewLine]", "]"}], "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"_String", "|", "#", "|", 
        RowBox[{"{", "#", "}"}]}], "&"}], "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_Integer", "|", "_Real"}], ")"}], "..."}], "]"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColorPattern", "[", "]"}], "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Alternatives", "[", "\[IndentingNewLine]", 
    RowBox[{"$namedColors", ",", "\[IndentingNewLine]", "$colorModels"}], 
    "\[IndentingNewLine]", 
    "]"}]}]}]}], \
"Code",ExpressionUUID->"c349d006-39e2-4aba-9349-52bab96c3244"],

Cell[BoxData[
 RowBox[{"Cases", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Hold", "[", 
    RowBox[{"Red", ",", "Blue", ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0", ",", "1", ",", "0", ",", ".5"}], "]"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0", ",", "1", ",", "0", ",", 
       RowBox[{"Print", "[", "1", "]"}]}], "]"}], ",", 
     RowBox[{"Print", "[", "1", "]"}], ",", 
     RowBox[{"Darker", "@", "Blue"}], ",", "Lighter"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", ":", 
     RowBox[{"ColorPattern", "[", "]"}]}], "\[RuleDelayed]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"HoldForm", "@", 
        RowBox[{"InputForm", "[", "c", "]"}]}], ",", "c"}], "}"}], "]"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", "1", "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Code",ExpressionUUID->"02fb5c37-072d-4e7b-a1be-12524fb4c574"]
}, Closed]],

Cell[CellGroupData[{

Cell["more oo?", \
"Section",ExpressionUUID->"1fd967fc-874a-4441-a237-2c5ba1c772e3"],

Cell["\<\
as we can see LocatorPane/Locator appearance is limited in interactivity and \
using separate objects while keeping locators invisible makes even \
LocatorPane slow.\
\>", "Text",ExpressionUUID->"303f70d2-8660-448e-bc97-bdbd08f79228"],

Cell[BoxData[{
 RowBox[{"Hold", "[", "Red", "]"}], "\[IndentingNewLine]", "Red"}], "Code",
 CellLabel->"In[42]:=",ExpressionUUID->"bb717be5-d40b-4129-8d17-572c82401cf9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "2"}], "}"}]}], "]"}]}], ";"}]}], "Code",
 CellLabel->"In[14]:=",ExpressionUUID->"be35738d-ee03-4376-b9db-64dc5a54dabf"],

Cell[BoxData[
 RowBox[{"opts", "=", " ", 
  RowBox[{"Sequence", "[", 
   RowBox[{
    RowBox[{"PlotRange", "\[Rule]", "1"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "333"}]}], 
   "]"}]}]], "Code",ExpressionUUID->"3a3ed18e-7cad-4795-ac35-04b2f80dfa8d"],

Cell[BoxData[
 RowBox[{"Deploy", "@", 
  RowBox[{"FrontEndModule", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"Locator", "[", 
            RowBox[{
             RowBox[{"Dynamic", "@", 
              RowBox[{"FrontEndSymbol", "[", 
               RowBox[{"\"\<point\>\"", ",", "#"}], "]"}]}], ",", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"FrontEnd`CurrentValue", "[", 
               RowBox[{"{", 
                RowBox[{"TaggingRules", ",", "\"\<locator\>\""}], "}"}], 
               "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "@", "n"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"AbsolutePointSize", "@", "7"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"LightLocator", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"FrontEndSymbol", "[", 
                RowBox[{"\"\<point\>\"", ",", "#"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Graphics", "[", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"RawBoxes", "@", 
                    RowBox[{"DynamicBox", "@", 
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "#"}], "]"}]}]}], ",", 
                    RowBox[{"Disk", "[", "]"}]}], "}"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "17"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\"\<MouseDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"FEPrivate`Set", "[", 
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "#"}], "]"}], ",", " ", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "]"}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"\"\<MouseUp\>\"", ":>", 
                    RowBox[{"FEPrivate`Set", "[", 
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "#"}], "]"}], ",", " ", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.", ",", "1.", ",", "0."}], "]"}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", "n", "]"}]}]}], "\[IndentingNewLine]", 
          "}"}], ",", "\[IndentingNewLine]", "opts", ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Table LightLocator@FrontEndSymbol\>\""}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Slider", "@", 
          RowBox[{"Dynamic", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FrontEndSymbol", "[", 
              RowBox[{"\"\<point\>\"", ",", "1"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Function", "@", 
               RowBox[{"Set", "[", 
                RowBox[{
                 RowBox[{"FrontEndSymbol", "[", 
                  RowBox[{"\"\<color\>\"", ",", "1"}], "]"}], ",", "Red"}], 
                "]"}]}], ",", "Automatic", ",", 
              RowBox[{"Function", "@", 
               RowBox[{"Set", "[", 
                RowBox[{
                 RowBox[{"FrontEndSymbol", "[", 
                  RowBox[{"\"\<color\>\"", ",", "1"}], "]"}], ",", "Green"}], 
                "]"}]}]}], "}"}]}], "]"}]}], ","}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<test\>\"", ",", 
         RowBox[{"FEPrivate`Set", "[", 
          RowBox[{
           RowBox[{"FrontEndSymbol", "[", 
            RowBox[{"\"\<another\>\"", ",", "1"}], "]"}], ",", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "]"}], ",", 
         RowBox[{"Evaluator", "\[Rule]", "Automatic"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Dynamic", "@", 
        RowBox[{
         RowBox[{"FrontEndSymbol", "[", 
          RowBox[{"\"\<another\>\"", ",", "1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Initialization", "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", "=", "i"}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"FrontEndSymbol", "[", 
              RowBox[{"\"\<point\>\"", ",", "i"}], "]"}], "=", 
             RowBox[{"pts", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"FrontEndSymbol", "[", 
              RowBox[{"\"\<color\>\"", ",", "i"}], "]"}], "=", "Green"}]}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FrontEndSymbol", "[", 
         RowBox[{"\"\<another\>\"", ",", "1"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}]}], ")"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Code",ExpressionUUID->"2a9c670c-05a2-46e4-b395-ed55f4cebaae"],

Cell["\<\
can we try to make a custom dynamic object with properties like active etc?

e.g. FrontEndSymbol[\[OpenCurlyDoubleQuote]name\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]id\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]property/action\[CloseCurlyDoubleQuote]]\
\>", "Text",ExpressionUUID->"3f99ff1f-fcc4-4f6c-ac00-b9b90490cb41"],

Cell[BoxData[
 RowBox[{"Deploy", "@", 
  RowBox[{"FrontEndModule", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Row", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"Locator", "[", 
            RowBox[{
             RowBox[{"Dynamic", "@", 
              RowBox[{"FrontEndSymbol", "[", 
               RowBox[{"\"\<point\>\"", ",", "#"}], "]"}]}], ",", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"FrontEnd`CurrentValue", "[", 
               RowBox[{"{", 
                RowBox[{"TaggingRules", ",", "\"\<locator\>\""}], "}"}], 
               "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "@", "n"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"AbsolutePointSize", "@", "7"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"LightLocator", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"FrontEndSymbol", "[", 
                RowBox[{"\"\<point\>\"", ",", "#"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Graphics", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "#"}], "]"}]}], ",", 
                    RowBox[{"Disk", "[", "]"}]}], "}"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "17"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\"\<MouseDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"FEPrivate`Set", "[", 
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "#"}], "]"}], ",", " ", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "]"}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"\"\<MouseUp\>\"", ":>", 
                    RowBox[{"FEPrivate`Set", "[", 
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "#"}], "]"}], ",", " ", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", "n", "]"}]}]}], "\[IndentingNewLine]", 
          "}"}], ",", "\[IndentingNewLine]", "opts", ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Table LightLocator@FrontEndSymbol\>\""}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Multicolumn", "[", 
          RowBox[{"#", ",", "3"}], "]"}], "&"}], " ", "@", " ", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", "=", "i"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Slider", "@", 
               RowBox[{"Dynamic", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"FrontEndSymbol", "[", 
                   RowBox[{"\"\<point\>\"", ",", "i"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"FEPrivate`Set", "[", 
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "i"}], "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{
                    {GrayLevel[0], RectangleBox[{0, 0}]}, 
                    {GrayLevel[0], RectangleBox[{1, -1}]}, 
                    {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
                    AspectRatio->1,
                    DefaultBaseStyle->"ColorSwatchGraphics",
                    Frame->True,
                    FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
                    FrameTicks->None,
                    
                    ImageSize->
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}],
                    PlotRangePadding->None],
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0", ",", "0"}], "]"}], NumberMarks -> 
                    False]],
                    Appearance->None,
                    BaseStyle->{},
                    BaselinePosition->Baseline,
                    ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
                    DefaultBaseStyle->{},
                    Evaluator->Automatic,
                    Method->"Preemptive"],
                    RGBColor[1, 0, 0],
                    Editable->False,
                    Selectable->False]}], "]"}], "&"}], ",", "Automatic", ",", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Set", "[", 
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "i"}], "]"}], ",", 
                    "Green"}], "]"}]}]}], "}"}]}], "]"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<MouseEntered\>\"", "\[RuleDelayed]", 
                 RowBox[{"FEPrivate`Set", "[", 
                  RowBox[{
                   RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "i"}], "]"}], ",", " ", 
                   RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "]"}]}], ",", 
                RowBox[{"\"\<MouseExited\>\"", "\[RuleDelayed]", 
                 RowBox[{"FEPrivate`Set", "[", 
                  RowBox[{
                   RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "i"}], "]"}], ",", " ", 
                   RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], "]"}]}]}], 
               "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}],
            "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]",
       "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Initialization", "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", "=", "i"}], "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"FrontEndSymbol", "[", 
             RowBox[{"\"\<point\>\"", ",", "i"}], "]"}], "=", 
            RowBox[{"pts", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"FrontEndSymbol", "[", 
             RowBox[{"\"\<color\>\"", ",", "i"}], "]"}], "=", "Green"}]}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   "]"}]}]], "Code",ExpressionUUID->"900f5233-2368-4849-8c13-3b73d834e39f"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<FE`DynObjDump`*\>\"", "]"}]], "Code",
 CellLabel->
  "In[225]:=",ExpressionUUID->"b0970dcf-ab63-431a-8d3a-a21d316bc530"],

Cell[BoxData[
 RowBox[{"Panel", "@", 
  RowBox[{"Dynamic", "[", 
   RowBox[{
    RowBox[{"Deploy", "@", 
     RowBox[{"FrontEndModule", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"Locator", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", 
                 RowBox[{"FrontEndSymbol", "[", 
                  RowBox[{"\"\<point\>\"", ",", "#"}], "]"}]}], ",", 
                RowBox[{"Dynamic", "@", 
                 RowBox[{"FrontEnd`CurrentValue", "[", 
                  RowBox[{"{", 
                   RowBox[{"TaggingRules", ",", "\"\<locator\>\""}], "}"}], 
                  "]"}]}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "@", "n"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"AbsolutePointSize", "@", "7"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"LightLocator", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"FrontEndSymbol", "[", 
                   RowBox[{"\"\<point\>\"", ",", "#"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "#"}], "]"}]}], ",", 
                    RowBox[{"Disk", "[", "]"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "17"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<MouseDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"FEPrivate`Set", "[", 
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "#"}], "]"}], ",", " ", 
                    "Red"}], "]"}], ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MouseUp\>\"", ":>", 
                    RowBox[{"FEPrivate`Set", "[", 
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "#"}], "]"}], ",", " ", 
                    "Green"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
                   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                 "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", "n", "]"}]}]}], "\[IndentingNewLine]", 
             "}"}], ",", "\[IndentingNewLine]", "opts", ",", 
            RowBox[{
            "PlotLabel", "\[Rule]", 
             "\"\<Table LightLocator@FrontEndSymbol\>\""}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Multicolumn", "[", 
             RowBox[{"#", ",", "3"}], "]"}], "&"}], " ", "@", " ", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", "=", "i"}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Slider", "@", 
                  RowBox[{"Dynamic", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<point\>\"", ",", "i"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"FEPrivate`Set", "[", 
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "i"}], "]"}], ",", "Red"}], 
                    "]"}]}], ",", "Automatic", ",", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Set", "[", 
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "i"}], "]"}], ",", 
                    "Green"}], "]"}]}]}], "}"}]}], "]"}]}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\"\<MouseEntered\>\"", "\[RuleDelayed]", 
                    RowBox[{"FEPrivate`Set", "[", 
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "i"}], "]"}], ",", " ", 
                    "Pink"}], "]"}]}], ",", 
                   RowBox[{"\"\<MouseExited\>\"", "\[RuleDelayed]", 
                    RowBox[{"FEPrivate`Set", "[", 
                    RowBox[{
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<color\>\"", ",", "i"}], "]"}], ",", " ", 
                    "Green"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Initialization", "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", "=", "i"}], "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"FrontEndSymbol", "[", 
                RowBox[{"\"\<point\>\"", ",", "i"}], "]"}], "=", 
               RowBox[{"pts", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", 
              RowBox[{
               RowBox[{"FrontEndSymbol", "[", 
                RowBox[{"\"\<color\>\"", ",", "i"}], "]"}], "=", 
               "Green"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ")"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ",", 
    RowBox[{"DestroyAfterEvaluation", "\[Rule]", "True"}], ",", 
    RowBox[{"CachedValue", "\[Rule]", 
     RowBox[{"ToBoxes", "@", 
      RowBox[{"Row", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ProgressIndicator", "[", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Percolate\>\""}], "]"}], 
          ",", "\"\<Loading...\>\""}], "}"}], ",", "\"\< \>\""}], "]"}]}]}], 
    ",", 
    RowBox[{"SynchronousUpdating", "\[Rule]", "False"}]}], 
   "]"}]}]], "Code",ExpressionUUID->"e13473ce-4b0e-475c-8321-784648acac9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hold", "[", 
   RowBox[{
    RowBox[{"Print", "[", "1", "]"}], ",", "Red"}], "]"}], "/.", 
  RowBox[{
  "_", "?", 
   "ColorQ"}]}]], \
"Code",ExpressionUUID->"d1f8f296-a07a-496e-ad43-292b645f0f42"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Defer", "@", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<asd\>\"", ",", 
     RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}]}]}]], "Code",
 CellLabel->
  "In[230]:=",ExpressionUUID->"9d17b82d-25a3-48c7-aa7b-3f850154e4f5"],

Cell[BoxData[""], \
"Code",ExpressionUUID->"4cfa9dc7-2447-44c8-b3df-1c40742bb12f"]
}, Closed]],

Cell[CellGroupData[{

Cell["questions", \
"Section",ExpressionUUID->"4da77557-6d27-4964-a059-7fb36d294f41"],

Cell[CellGroupData[{

Cell["\<\
why FEPrivate`Or[sym1, sym2] is True when they have no value?\
\>", "Subsubsection",ExpressionUUID->"91175454-d12f-4c7f-9509-f2821d8af37c"],

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RawBoxes", "@", 
      RowBox[{"DynamicBox", "[", "\[IndentingNewLine]", 
       RowBox[{"FEPrivate`If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FEPrivate`SameQ", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"FEPrivate`Or", "[", " ", 
            RowBox[{"x", ",", " ", "y"}], "]"}], ",", "\[IndentingNewLine]", 
           "True"}], "]"}], ",", "\[IndentingNewLine]", " ", "\"\<True\>\"", 
         ",", "\[IndentingNewLine]", "\"\<False\>\"", ",", 
         "\[IndentingNewLine]", "\"\<Maybe\>\""}], "\[IndentingNewLine]", 
        "]"}], "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"RawBoxes", "@", 
      RowBox[{"DynamicBox", "[", "\[IndentingNewLine]", 
       RowBox[{"FEPrivate`Or", "[", " ", 
        RowBox[{"x", ",", " ", "y"}], "]"}], "\[IndentingNewLine]", "]"}]}]}],
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]], "Code",
 CellChangeTimes->{{3.7365898056724157`*^9, 3.7365900296189384`*^9}, {
  3.7365900648283525`*^9, 3.7365900795383716`*^9}, {3.7365903807306423`*^9, 
  3.7365904335923615`*^9}, {3.736590715480523*^9, 3.736590740375333*^9}, {
  3.736591179374421*^9, 3.736591180957604*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"376c5a66-beb6-4385-80d0-692c10b01e1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
what is the point of the outer wrapper for locator expression?\
\>", "Subsubsection",ExpressionUUID->"a0774f6c-0777-4529-b00a-6e433ceacf97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FrontEndResource", "[", 
   RowBox[{"\"\<FEExpressions\>\"", ",", "\"\<LocatorDefaultThumb\>\""}], 
   "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1"}], "]"}], 
  "]"}]], "Code",ExpressionUUID->"d266c146-d5f0-4ceb-984e-70d8552db6a8"],

Cell["\<\
using this works as well but is much smoother for more complicated cases. The \
downside is that I can\[CloseCurlyQuote]t use it without help of the Kernel \
as FE only is not able to #[[1,1]].\
\>", "Text",ExpressionUUID->"4e4bd443-71aa-4846-b880-11c44f2b9ada"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["minesweeper (in progress)", \
"Section",ExpressionUUID->"5321755e-3e6c-44a2-bd92-4a2ce03448e7"],

Cell[BoxData[
 TemplateBox[{
  "\"https://mathematica.stackexchange.com/q/66133/5478\"",
   "https://mathematica.stackexchange.com/q/66133/5478"},
  "HyperlinkURL"]], \
"Code",ExpressionUUID->"64c7d51d-fcbb-4cde-a62a-4be7e87772f4"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\n", 
 RowBox[{
  RowBox[{"path", "=", 
   RowBox[{
    RowBox[{"\"\<http://i.stack.imgur.com//\>\"", "<>", "#"}], "&"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"filenames1", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<P22Go.jpg\>\"", ",", "\"\<Zh27M.jpg\>\"", ",", "\"\<vKZZr.jpg\>\"", 
     ",", "\"\<2CYDF.png\>\""}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"TL", ",", "BR", ",", "clock", ",", "mine"}], "}"}], "=", 
   RowBox[{"Import", "/@", 
    RowBox[{"path", "/@", "filenames1"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"topleft", ",", "bottomright"}], "}"}], "=", 
   RowBox[{"ImageData", "/@", 
    RowBox[{"{", 
     RowBox[{"TL", ",", "BR"}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"filenames2", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<VngIV.jpg\>\"", ",", "\"\<WeIqo.jpg\>\"", ",", "\"\<fvub6.jpg\>\"", 
     ",", "\"\<rb5P7.jpg\>\"", ",", "\"\<fl5W2.jpg\>\"", ",", 
     "\"\<NowyY.jpg\>\"", ",", "\"\<5Pp3F.jpg\>\"", ",", "\"\<9pNCj.jpg\>\"", 
     ",", "\"\<vMIXr.jpg\>\""}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"numberpictures", "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{"numberpictures", "[", "n", "]"}], "=", 
     RowBox[{"Import", "[", 
      RowBox[{"path", "@", 
       RowBox[{"filenames2", "[", 
        RowBox[{"[", 
         RowBox[{"n", "+", "1"}], "]"}], "]"}]}], "]"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"backgroundcolor", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.698", ",", "0.757", ",", "0.831"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"spacecolor", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.839", ",", "0.890", ",", "0.953"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"numbercolor", "=", 
   RowBox[{"RGBColor", "@@@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.247", ",", "0.314", ",", "0.737"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.122", ",", "0.408", ",", "0.004"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.682", ",", "0.008", ",", "0.020"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.027", ",", "0.004", ",", "0.502"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.49", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0.49", ",", "0.495"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], 
  ";"}]}], "Code",ExpressionUUID->"d13f486d-0513-4cb3-93d7-c60ec4f08802"],

Cell[BoxData[
 RowBox[{"back", "[", 
  RowBox[{"1", ",", "2"}], "]"}]], "Code",
 CellLabel->"In[56]:=",ExpressionUUID->"47ba6c6e-8a77-4105-a202-098691aac3e9"],

Cell[BoxData[
 RowBox[{"Image", "@", "topleft"}]], "Code",
 CellLabel->"In[58]:=",ExpressionUUID->"e9d52c00-db11-4c5a-926f-5cf74ccd522a"],

Cell[BoxData[
 RowBox[{"bottomright", "//", "Image"}]], "Code",
 CellLabel->"In[59]:=",ExpressionUUID->"e6ac98dc-481c-46d0-bddc-e5dc86999d10"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"block", "[", 
      RowBox[{"{", 
       RowBox[{"i_", ",", "j_", ",", "type1_", ",", "type2_"}], "}"}], "]"}], 
     ":=", 
     RowBox[{
      RowBox[{"block", "[", 
       RowBox[{"i", ",", "j", ",", "type1", ",", "type2"}], "]"}], "=", 
      RowBox[{"Switch", "[", 
       RowBox[{"type1", ",", "\[IndentingNewLine]", "0", ",", 
        RowBox[{"{", 
         RowBox[{"TaggingRules", ",", "\"\<cover\>\""}], "}"}], ",", 
        "\[IndentingNewLine]", "1", ",", 
        RowBox[{"Switch", "[", 
         RowBox[{"type2", ",", "\[IndentingNewLine]", 
          RowBox[{
          "0", "|", "1", "|", "2", "|", "3", "|", "4", "|", "5", "|", "6", 
           "|", "7", "|", "8"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "TaggingRules", ",", "\"\<numberpictures\>\"", ",", "type2"}], 
           "}"}], 
          RowBox[{"(*", 
           RowBox[{"numberpictures", "[", "type2", "]"}], "*)"}], ",", 
          "\[IndentingNewLine]", "9", ",", 
          RowBox[{"{", 
           RowBox[{"TaggingRules", ",", "\"\<mine\>\""}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ini", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mat1", ",", "mat2", ",", "modify"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"modify", "[", 
          RowBox[{"mat_", ",", 
           RowBox[{"{", 
            RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[NotEqual]", "9"}], 
           ",", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"mat", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", 
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], ";;", 
                    RowBox[{"Min", "[", 
                    RowBox[{"16", ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}], ";;", 
                    RowBox[{"Min", "[", 
                    RowBox[{"30", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}]}]}], "]"}], "]"}], ",", 
                "9", ",", "2"}], "]"}]}]}], "]"}], ",", "mat"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"mat1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "16"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "30"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mat2", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"RandomSample", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"9", "&"}], "/@", 
                RowBox[{"Range", "[", "99", "]"}]}], ",", 
               RowBox[{
                RowBox[{"0", "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"16", "*", "30"}], "-", "99"}], "]"}]}]}], "}"}]}], 
            "]"}], ",", "30"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mat2", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"List", ",", 
           RowBox[{"Fold", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"modify", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "mat2", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Array", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"16", ",", "30"}], "}"}]}], "]"}], ",", "1"}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{"mat1", ",", "mat2", ",", "3"}], "]"}]}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"CreateDialog", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FrontEndModule", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DynamicModule", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"board", "=", "ini"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Column", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Spacer", "[", "30", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"i", "=", "i"}], ",", 
                    RowBox[{"j", "=", "j"}]}], "}"}], ",", 
                  RowBox[{"RawBoxes", "[", 
                   RowBox[{"DynamicBox", "[", 
                    RowBox[{"CurrentValue", "[", 
                    RowBox[{"FrontEndSymbol", "[", 
                    RowBox[{"\"\<board\>\"", ",", "i", ",", "j"}], "]"}], 
                    "]"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "16"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "30"}], "}"}]}], "]"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"ImageSize", "\[Rule]", "1200"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Spacings", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Black", ",", "Thick"}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Spacer", "[", "60", "]"}], ",", "clock", ",", 
               RowBox[{"Spacer", "[", "700", "]"}], ",", "mine", ",", 
               RowBox[{"Spacer", "[", "30", "]"}]}], "}"}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Initialization", "\[RuleDelayed]", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"getpos", "[", "]"}], ":=", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"pos", "=", 
                 RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}], 
                "}"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"pos", "===", "None"}], ",", "None", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
                   RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "@", "pos"}], ",", "360"}], "]"}]}], 
                  "+", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"click", "[", 
              RowBox[{"board_", ",", "\"\<Left\>\""}], "]"}], ":=", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"coor", "=", 
                 RowBox[{"getpos", "[", "]"}]}], "}"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"coor", "===", "None"}], ",", "board", ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"board", ",", 
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"coor", ",", "3"}], "}"}], "]"}], "\[Rule]", 
                    "1"}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"SetOptions", "[", 
             RowBox[{
              RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
              RowBox[{"NotebookEventActions", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<MouseUp\>\"", ",", "1"}], "}"}], 
                  "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{"board", "=", 
                    RowBox[{"click", "[", 
                    RowBox[{"board", ",", "\"\<Left\>\""}], "]"}]}], ")"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<MouseUp\>\"", ",", "2"}], "}"}], 
                  "\[RuleDelayed]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Right \>\"", ",", 
                    RowBox[{"Print", "@", 
                    RowBox[{"getpos", "[", "]"}]}]}], "}"}]}]}], 
                "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
             "]"}]}], "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]",
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Initialization", "\[RuleDelayed]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "=", "i"}], ",", 
              RowBox[{"j", "=", "j"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"FrontEndSymbol", "[", 
              RowBox[{"\"\<board\>\"", ",", "i", ",", "j"}], "]"}], "=", 
             RowBox[{"block", "@", 
              RowBox[{"ini", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "16"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "30"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Background", "\[Rule]", "backgroundcolor"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"WindowTitle", "\[Rule]", "\"\<Minesweeper By apple\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"WindowMargins", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "0"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"TaggingRules", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<numberpictures\>\"", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ToBoxes", "/@", 
             RowBox[{"numberpictures", "[", "#", "]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "8"}], "]"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<cover\>\"", "\[Rule]", 
         RowBox[{"ToBoxes", "@", 
          RowBox[{"Image", "@", "topleft"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mine\>\"", "\[Rule]", 
         RowBox[{"ToBoxes", "@", 
          RowBox[{"ImageCompose", "[", 
           RowBox[{
            RowBox[{"Image", "@", "topleft"}], ",", "mine"}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Code",ExpressionUUID->"1226ce3e-b15e-487e-92f0-b18a09fd5871"],

Cell[BoxData[
 RowBox[{"numberpictures", "[", "1", "]"}]], "Code",
 CellLabel->
  "In[101]:=",ExpressionUUID->"d93e937a-7fe6-4347-b865-ce11e5cd58d6"],

Cell[BoxData["board"], "Code",
 CellLabel->"In[17]:=",ExpressionUUID->"c6fdaa16-82ab-49bc-973f-73b7499f06d6"],

Cell[BoxData["ini"], "Code",
 CellLabel->"In[18]:=",ExpressionUUID->"ce3b8a9e-bb5e-4dbd-9b9b-2472c362bc72"],

Cell[BoxData[
 RowBox[{"FrontEndModule", "[", "\[IndentingNewLine]", 
  RowBox[{"Style", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RawBoxes", "@", 
     RowBox[{"DynamicBox", "[", 
      RowBox[{"CurrentValue", "[", 
       RowBox[{"{", 
        RowBox[{"TaggingRules", ",", "\"\<numberpictures\>\"", ",", "1"}], 
        "}"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"TaggingRules", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<numberpictures\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"ToBoxes", "@", 
         RowBox[{"numberpictures", "[", "1", "]"}]}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   "]"}]}]], "Code",ExpressionUUID->"c1572b01-d442-447b-ac15-a86345c3edde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numberpictures", "[", "1", "]"}], "//", 
  "ImageDimensions"}]], "Code",
 CellLabel->"In[73]:=",ExpressionUUID->"34c85a47-f3bf-4e09-9b3d-0edf2e7b4583"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToBoxes", "@", 
   RowBox[{"Image", "@", "topleft"}]}], "//", "RawBoxes"}]], "Code",
 CellLabel->"In[86]:=",ExpressionUUID->"c5c879f9-0668-4be6-8ffd-1289ad96bbe6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToBoxes", "@", 
   RowBox[{"ImageCompose", "[", 
    RowBox[{
     RowBox[{"Image", "@", "topleft"}], ",", "mine"}], "]"}]}], "//", 
  "RawBoxes"}]], "Code",
 CellLabel->"In[87]:=",ExpressionUUID->"4aa4a913-c7dd-4c4b-8ac8-044b64170620"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RawBoxes", "/@", 
    RowBox[{"ToBoxes", "/@", 
     RowBox[{"numberpictures", "[", "#", "]"}]}]}], "&"}], "/@", 
  RowBox[{"Range", "[", 
   RowBox[{"0", ",", "8"}], "]"}]}]], "Code",
 CellLabel->"In[88]:=",ExpressionUUID->"c8fe9adb-1e5a-4c79-9ba4-24cf7a18fad1"]
}, Closed]]
}, Open  ]]
},
WindowSize->{1790, 1022},
WindowMargins->{{Automatic, 141}, {Automatic, 174}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
TrackCellChangeTimes->False,
Magnification:>1.2 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->FrontEnd`FileName[{"DevTools"}, "DevPackageDark.nb", 
  CharacterEncoding -> "UTF-8"]
]

